<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Blogs on 无名空间</title><link>http://xiehao.github.io/blogs/</link><description>Recent content in Blogs on 无名空间</description><generator>Hugo -- gohugo.io</generator><lastBuildDate>Thu, 19 Jan 2023 14:57:00 +0800</lastBuildDate><atom:link href="http://xiehao.github.io/blogs/index.xml" rel="self" type="application/rss+xml"/><item><title>在Docker中搭建JupyterHub服务器</title><link>http://xiehao.github.io/blogs/2023-01-19-docker-jupyterhub/</link><pubDate>Thu, 19 Jan 2023 14:57:00 +0800</pubDate><guid>http://xiehao.github.io/blogs/2023-01-19-docker-jupyterhub/</guid><description>功能需求 支持通过web访问Jupyter服务器 支持多用户同时访问，且环境相互隔离 支持用户间共享目录 支持访问Nvidia显卡（如果有） 核心思想 在Docker中开启JupyterHub服务器 在上述服务器中为每个用户开启一个JupyterLab容器 所需软件 git docker docker-compose nvidia cuda nvidia-container-toolkit 主要步骤 克隆仓库 jupyterhub-deploy-docker至本地 git clone https://github.com/jupyterhub/jupyterhub-deploy-docker.git 自定义少量配置 修改每个用户启动jupyter notebook所用镜像为cschranz/gpu-jupyter以支持nvidia显卡 在docker-compose.yaml文件中，services的environment下将DOCKER_NOTEBOOK_IMAGE的值修改为cschranz/gpu-jupyter:latest 设置多用户均可访问的共享文件夹/home/jovyan/shared，可在其内实现多人合作编辑 在jupyterhub_config.py文件中，修改变量c.DockerSpawner.volumns的值： c.DockerSpawner.volumes = { &amp;#39;jupyterhub-user-{username}&amp;#39;: notebook_dir, &amp;#39;jupyterhub-shared&amp;#39;: { &amp;#39;bind&amp;#39;: &amp;#39;/home/jovyan/shared&amp;#39;, &amp;#39;mode&amp;#39;: &amp;#39;rw&amp;#39; } } 令单用户容器可访问主机显卡 在jupyterhub_config.py文件中，新增若干行以设置变量c.DockerSpawner.extra_host_config的值： c.DockerSpawner.extra_host_config = { &amp;#34;device_requests&amp;#34;: [ docker.types.DeviceRequest( count=-1, capabilities=[[&amp;#34;gpu&amp;#34;]], ), ], } 在开启服务后，为共享目录加入其他用户的写入权限（默认无法写入） sudo chmod -R o+w /path/to/docker/volumns/jupyterhub-shared 开启、关闭jupyterhub服务 拉取创建用户jupyterlab所需镜像
docker pull cschranz/gpu-jupyter 开启jupyterhub服务器
docker-compose up -d 关闭jupyterhub服务器
docker-compose down 后续设置 在开启服务后，为主机的共享目录加入其他用户的写入权限（默认无法写入） sudo chmod -R o+rw /path/to/docker/volumns/jupyterhub-shared 用户使用 若服务器的IP地址为x.</description></item></channel></rss>